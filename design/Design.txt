一、主要功能：
01：文本相似度计算。
02：支持用户自定义停用词。
03：校验导入文件的合规性，并提供错误明细报告
04：计算结果可导出、可预览。
05：复位程序代替重启程序。
06：显示程序运行日志，输出辅助信息。
07：提供导入模板下载。


二、功能实现：
01：用户接口：用户通过配置文件进行自定义停用词设置交互。
02：导入功能：设置1个LineEdit显示导入的文件路径及文件名，仅可导入指定扩展名的文件。
03：校验功能：对文件是否被导入、文件是否可访问(文件是否存在、权限、假扩展名)、文件字段是否存在、数值类型是否匹配等进行检查，并提供错误明细报告。
04：计算功能：绑定计算槽函数完成计算。
05：预览功能：计算结束后可随机预览N条记录并可刷新，显示于TableWidget控件中。
06：导出功能：将计算结果导出为Excel文件保存。
07：复位功能：如需对不同的导入文件进行计算，可使用复位功能快速操作，无需退出重启程序。
08：日志功能：用ListWidget显示程序运行行为(如按钮或菜单的点击以及校验结果等相关信息的反馈)。
09：模板功能：可下载导入模板。
10：更新日志：弹出MsgBox对话框显示日志更新记录。
11：关于功能：弹出MsgBox对话框显示程序版本等信息。
12：焦点功能：获得焦点的按钮可以响应回车键。


三、程序架构：
01：窗体设计：1个主窗体(程序运行界面)，调用“预览”窗体，共2个QMainWindow类窗体。
02：文件结构：采用单继承的界面与逻辑分离结构，每个窗体都由ui文件生成“ui转py”文件，然后根据此“ui转py”文件编写该窗体的logic的py文件，其中主窗体的逻辑py文件调用“预览”窗体的逻辑py文件，并实现全部功能（另一种模式是由主窗体直接管理改为各窗体自治，即在各窗体内完成自身功能实现，主窗体仅进行调用），最后新建1个py文件调用主窗体的逻辑py文件，通过逻辑清晰、层次分明的文件组织与调用，实现程序功能。
03：建立公共原子类、公共装饰器类py文件模块，由主窗体的逻辑py文件调用，以简洁代码。


四、工作过程：
01：窗体初始化载入状态：“校验”、“报告”、“计算”、“预览”、“导出”按钮及菜单项熄灭不可用，PublicAtomClass设置1个标志位变量flag_write_header=True，表示需要写入表头字段名，PrivateAtomClass设置1个标志位变量flag_run_generate_stopwords=True，表示需要调用停用词函数。设置全局变量df_userdata=空DataFrame()，以便“校验”、“报告”、“计算”、“预览”、“导出”进行调用。
02：窗体尺寸：主窗体及“预览”2个窗体分别采用网格布局和水平布局，实现控件自适应窗口大小。
03：导入动作：LineEdit灰色文本提示导入Excel文件，并设为只读以禁止用户进行不必要的输入。点击“导入”按钮或菜单项打开“打开”对话框，如果点击该对话框的“取消”按钮，则程序不采取任何动作，仅在ListWidget输出提示信息“导入已被取消”，继续等待导入文件，如果选中文件并点击了该对话框的“打开”按钮，则点亮“校验”按钮及菜单项，同时“导入”按钮及菜单项熄灭，ListWidget输出提示信息“已选择导入”+文件具体路径(含文件名)，LineEdit同时显示文件具体路径(含文件名)。
04：校验动作：首先，直接读取Excel到DataFrame(需赋值给全局变量，以便后续计算、预览、导出调用)以检验文件是否可访问，利用异常捕获机制来检查是否存在问题(包括文件是否存在、是否具有访问权限、是否更改的假扩展名、是否仅有标题而内容为空等)，其次，在顺利读取文件之后，直接检查目标字段数值类型，再次利用异常捕获机制来检查是否存在问题(包括目标字段是否存在、目标字段数值类型是否正确)，最后，统计每条记录的每个目标字段值类型是否都符合要求。如果以上3步异常检测都没问题，“计算”按钮及菜单项点亮，同时“校验”按钮及菜单项熄灭，“报告”按钮及菜单项保持熄灭或改为熄灭(因为有可能不是首次校验，所以先判断状态，如果是点亮的就熄灭，原本就是熄灭的则不用处理)，ListWidget输出提示信息“文件校验通过”；如果校验字段类型有问题，LineEdit中显示的路径信息清空，“校验”按钮及菜单项熄灭，“报告”按钮及菜单项点亮(先检查状态，如果是熄灭的则点亮，如果是点亮的则不处理，因为有可能不是首次检验)，“导入”按钮及菜单项点亮，ListWidget输出提示信息“校验未通过”+具体报错信息(浅红色字体)，用户可下载报告查看明细问题，等待用户处理后再次导入；如果是文件不存在或存在但访问失败或访问成功但字段不存在或字段存在但无内容记录，则LineEdit中显示的路径信息清空，“校验”按钮及菜单项熄灭，“报告”按钮及菜单项要熄灭(以免上一次检验结果误导用户，先判断使能状态，如果是点亮的则熄灭，如果原本就是熄灭的则不用处理)，“导入”按钮及菜单项点亮，ListWidget输出提示信息“校验未通过：文件或字段不存在或文件内容为空（具体实现时已在异常检测阶段按类别分开提示了）”，等待用户处理后再次导入。
05：报告下载：校验过程中，文件访问失败或字段不存在均不必生成报告，仅输出提示即可，字段数据类型不匹配时才生成报告，以供用户下载详单查看具体不满足条件的记录后快速处理。类似于导出动作。打开“另存为”对话框，将校验后的DataFrame保存为Excel文件。如果点击该对话框的“取消”按钮，则程序不采取任何动作，仅在ListWidget输出提示信息“校验报告下载已被取消”，继续等待下载校验报告，如果点击了该对话框的“保存”按钮，则ListWidget输出提示信息“校验报告下载成功，已保存至”+文件具体路径(含文件名)，同时弹出MsgBox对话框，“校验报告已下载至+具体路径(不含文件名)，是否打开该目录？”，程序根据用户选择结果，决定是否打开资源管理器，刚下载的校验报告文件以焦点显示。
06：计算动作：在上一步异常检测校验通过后，调用相关槽函数进行计算(需删除校验过程中生成的校验结果字段列)，ListWidget输出提示信息“开始计算”、换行显示“尝试读取用户自定义停用词文件”，先对用户自定义停用词文件进行处理，直接读取该文件，利用异常捕获机制来检查是否存在问题(包括文件是否存在、是否具有访问权限、是否更改的假扩展名等)，如果没有异常，ListWidget输出提示信息“用户自定义停用词文件读取成功！本次计算将启用此增强功能。”，如果存在异常，则ListWidget输出提示信息“用户自定义停用词文件访问失败，本次计算将忽略此增强功能。(浅红色字体)”，接着进行后续计算直到结束(由于apply是重复调用函数的，而函数内层获取停用词集合的函数在本次计算事件中只需执行1次即可，因此设立标志位初始值为flag_run_generate_stopwords=True，在完成首次调用后，立即设置为False，指示后续循环中不再调用，另外再设立1个实例属性用于保存停用词集合，因为在函数内调用的内层停用词函数返回值只对该次调用有效，apply重复调用函数时内层停用词函数不执行是没有返回值的)，计算时要操作的DataFrame已经在校验过程中存储在了实例属性中(以便预览窗体可以共享访问)，ListWidget输出提示信息“计算完成，共耗时XXX秒”，“预览”、“导出”按钮及菜单项点亮，同时“计算”按钮及菜单项熄灭；如果出现异常情况导致计算失败，则ListWidget输出提示信息“出现意外状况导致计算失败：{repr(e)}，请确认导入的文件是否有效，或联系软件开发者处理。”，然后清空LineEdit文本框、还原标志位为flag_run_generate_stopwords = True、“计算”按钮及菜单项熄灭、“导入”按钮及菜单项点亮。
07：预览动作：点击“预览”按钮或菜单项，弹出“预览”窗体，随机显示min(20,df_userdata.shape[0]//3+1)条记录到TableWidget。如果flag_write_header=True，那么首先完成表头写入并立即更改标志位，设置flag_write_header=False，以供下次预览及刷新不同记录时调用，避免重写表头的冗余动作，然后通过循环写入各单元格数据；如果flag_write_header=False，说明之前已经写过表头了，那么只需写入各单元格数据即可(另一种做法是，“预览”按钮的动作分解为“写表头”和“写各单元格”2个函数，调用“预览”窗体时调用这2个函数，预览窗体中的“刷新”按钮只需调用“写各单元格”函数，无需判断是否需要写表头及标志位，因为预览的始终是同一份数据，表头字段名没有变化，只是不同的记录而已。)，窗体模态为ApplicationModal应用程序级别(本程序其它窗体不响应，其它应用程序可响应)。ListWidget输出提示信息“随机预览数据”(预览窗体中的“刷新”按钮在ListWidget中输出提示信息“刷新预览数据”，“导出”按钮的动作及输出提示信息与主窗体的“导出”按钮一致，调用相同的槽函数)。
08：导出动作：主窗体的“导出”、预览窗体的“导出”与“报告”三者动作相同，调用相同的槽函数。通过信号发送者信息返回字典值字符串，以标注不同提示信息。打开“另存为”对话框，将计算结果DataFrame保存为Excel文件。如果点击该对话框的“取消”按钮，则程序不采取任何动作，仅在ListWidget输出提示信息“导出文件下载已被取消”，继续等待导出文件，如果点击了该对话框的“保存”按钮，有异常则输出异常，正常情况下，ListWidget输出提示信息“导出文件下载成功，已保存至”+文件具体路径(含文件名)，同时弹出MsgBox对话框，“导出文件已下载至+具体路径(不含文件名)，是否打开该目录？”，程序根据用户选择结果，决定是否打开资源管理器，刚导出的文件以焦点显示。
09：模板下载：类似于导出动作。打开“另存为”对话框，将内置DataFrame保存为Excel文件。如果点击该对话框的“取消”按钮，则程序不采取任何动作，仅在ListWidget输出提示信息“导入模板下载已被取消”，继续等待下载模板，如果点击了该对话框的“保存”按钮，有异常则输出异常，正常情况下，ListWidget输出提示信息“导入模板下载成功，已保存至”+文件具体路径(含文件名)，同时弹出MsgBox对话框，“导入模板已下载至+具体路径(不含文件名)，是否打开该目录？”，程序根据用户选择结果，决定是否打开资源管理器，刚下载的模板文件以焦点显示。
10：复位动作：将UI恢复到程序初始化载入状态(包括各按钮及菜单项的使能状态、标志位还原)，计算过程中产生的变量占用内存空间问题(如PublicAtomClass的DataFrame、预览窗体的TableWidget数据源等)由语言垃圾回收机制处理。LineEdit文本框清空，“导入”按钮及菜单项点亮，“校验”、“报告”、“计算”、“预览”、“导出”按钮及菜单项熄灭，还原标志位为flag_write_header=True，以供下一次计算新的数据后点击“预览”(含“刷新”)按钮及菜单项时调用，还原标志位为flag_run_generate_stopwords=True，以供下一次计算新的数据后点击“计算”按钮及菜单项时调用，ListWidget文本框不清空且追加提示信息“程序被第N次复位”。
11：日志消息：点击“日志”菜单项，弹出MsgBox对话框显示更新日志信息。
12：关于消息：点击“关于”菜单项，弹出MsgBox对话框显示程序版本等信息。



升版预告：
1、“报告”、“导出”、“模板”3个动作执行后的MsgBox提供3个按钮，分别是“打开文件”、“打开目录”、“关闭”，用户点击后执行相应动作。
2、Loading界面显示无限循环进度条
3、增加右键快捷菜单
4、状态栏信息跑马灯（卷动显示固定文字），校验和计算过程中，状态栏停止跑马灯并显示状态文字提示信息及简单动画，校验和计算完毕倒计时3秒后恢复跑马灯
5、增加评价功能，并从注册表取数计算得分比例，__main__部分读取评价信息封装为函数调用
6、增加设置功能，在设置窗体中设置目标字段名称（以逗号隔开，需检查字段数量）、目标字段数据类型（以逗号隔开，不检查数量）、选择停用词文件(需要异常检测)，是否启用设置（不启用则硬编码赋值，启用则读取用户输入的内容改写硬编码），设置信息保存到注册表，下次启动调用已设置信息。
